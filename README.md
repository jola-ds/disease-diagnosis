# Disease Diagnosis Project

## Overview

A machine learning project that predicts diseases from symptoms and patient data.
This project demonstrates how data science can support early diagnosis and healthcare
decision-making in low-resource settings.

---

## Problem Statement

Nigeria faces a dual burden of communicable and non-communicable diseases. Malaria,
tuberculosis, HIV/AIDS, and cholera remain widespread, while hypertension, diabetes,
and cardiovascular disease are sharply rising
([WHO, 2023](https://www.afro.who.int/sites/default/files/2023-08/Nigeria.pdf);
[AHA Journals, 2023](https://www.ahajournals.org/doi/10.1161/CIRCULATIONAHA.123.063671)).
Malaria alone contributes substantially to mortality and morbidity ([Reuters, 2024](https://www.reuters.com/business/healthcare-pharmaceuticals/nigeria-rolls-out-new-oxford-r21-malaria-vaccine-2024-10-17/)).

At the same time, access to timely medical intervention is limited
outside major cities, worsening preventable illness and death ([PMC, 2013](https://pmc.ncbi.nlm.nih.gov/articles/PMC3560225/); [2020](https://pmc.ncbi.nlm.nih.gov/articles/PMC7436948/)). In low-resource settings, limited infrastructure, understaffing, and
inequitable access to care remain persistent challenges, leading to gaps in diagnosis and
treatment.

Machine learning (ML) offers a way forward. Research has shown its potential in:

- Predicting under-five mortality in Nigeria with up to 89.47% accuracy
([BMC Med Inform Decis Mak, 2024](https://bmcmedinformdecismak.biomedcentral.com/articles/10.1186/s12911-024-02476-5))
- Supporting HIV treatment adherence in Nigerian patients ([PMC, 2024](https://pmc.ncbi.nlm.nih.gov/articles/PMC12021289/))
- Enhancing outbreak prediction for diseases like cholera
([Exploration Journals, 2023](https://www.explorationpub.com/Journals/edht/Article/101140))

Full Reference List: [`citations.md`](citations.md)

### Scope

This project, therefore, addresses the urgent need for accessible, privacy-safe, and
context-aware disease prediction tools. Using **domain-informed synthetic Nigerian
hospital data**, a machine learning predictor was tailored to local healthcare
realities.

‚ö†Ô∏è While not a substitute for clinical expertise, this system demonstrates how
AI-driven models can serve as decision support tools for healthcare workers in
low-resource settings‚Äîhelping flag likely diseases earlier, guide triage, and
ultimately improve patient outcomes.

---

## Features

- Confidence intervals for model metrics via Bootstrap resampling (uncertainty estimates)
- Confidence score for each prediction (model probability for the predicted disease)
- Interactive demo for real-time prediction

---

## Dataset

A synthetic dataset was generated by simulating patient-level disease occurrence and symptoms in Nigeria. Each record includes:

- **Demographics:** age, gender, setting, region, and season.
- **Diagnosis:** one of 10 diseases or "healthy (or undiagnosed)".
- **Symptoms:** binary indicators for 15 common symptoms.

The generator applies:

- Epidemiologically-informed **disease prevalence and demographic adjustments**
- **Seasonal effects**, **symptom correlations**, and **comorbidities**
- Optional **balanced disease datasets** or user-controlled "healthy" share.

The dataset is **validated** against realistic patterns (e.g., malaria peaks in rainy season, measles is pediatric-focused) and provides comprehensive statistics.  

For a thorough overview, see [`data/README.md`](data/README.md)

---

## Workflow

1. **Preprocessing**
   - Categorical encoding (`OneHotEncoder`) for non-numeric columns.
   - Feature selection: symptoms + basic patient data.

2. **Modeling**
   - Random Forest & XGBoost classifiers.
   - Balancing via sample weights to handle class imbalance.

3. **Evaluation**
   - Metrics: Accuracy, classification report.
   - Visualization: Confusion matrices, calibration plots.
   - Real-world add-on: Bootstrap confidence intervals to estimate uncertainty.

---

## Notebooks

- [`notebooks/disease_diagnosis_demo.ipynb`](notebooks/disease_diagnosis_demoe.ipynb): Full demo with preprocessing, model
training, evaluation, and confidence intervals.

---

## Scripts

- [`src/data_generator.py`](src/data_generator.py): Synthetic dataset generator module.
- [`src/train.py`](src/train.py): Training utilities
- [`src/eval.py`](src/eval.py): Evaluation utilities.
- [`src/demo.py`](src/demo.py): Project demo

---

## Results (XGBoost Classifier)

Final model: **XGBoost**, selected after baseline comparison with Random Forest.

- **Overall accuracy:** **74.6%** on the held-out test set (2,000 patients).  
- **Macro F1-score:** ~0.70 across 11 classes.  
- **Weighted F1-score:** 0.75 (reflecting balanced performance across common and less common diseases).  

### Per-class highlights

- **Strong performance:**  
  - *Malaria* (F1 = 0.86)  
  - *Measles* (0.82)  
  - *Healthy* (0.89)  

- **Moderate performance:**  
  - *Tuberculosis* (0.66)  
  - *Typhoid* (0.68)  

- **Lower performance:**  
  - *Hypertension* (recall = 0.47), reflecting higher class difficulty.  

Confusion matrices and calibration plots are available in the [`/plots`](plots/) folder.  
Full classification reports and bootstrap confidence intervals are documented in the [notebook](notebooks/disease_diagnosis_demo.ipynb).  

---

## Getting Started

Follow these steps to set up and run the Disease Diagnosis Project.

### 1. Clone the Repository

```bash
git clone https://github.com/<your-org>/<your-repo>.git
cd <your-repo>
```

### 2. (Recommended) Create a Virtual Environment

```bash
python -m venv .venv
# On Windows:
.venv\Scripts\activate
# On macOS/Linux:
source .venv/bin/activate
```

### 3. Install Dependencies

```bash
pip install -r requirements.txt
```

### 4. Run the Notebook

You can explore the full workflow, data generation, and model evaluation in the Jupyter notebook:

```bash
jupyter notebook notebooks/disease_diagnosis_demo.ipynb
```

Or open the notebook directly in Visual Studio Code and use the built-in Jupyter support.

---

### 5. Command-Line Usage

```bash
# Train and save the best model
python main.py train

# Evaluate the saved model on the test set
python main.py evaluate --model models/final_model.pkl

# Run a quick single-sample prediction demo
python main.py demo --model models/final_model.pkl
```

---

**Note:**  
If you encounter missing package errors, install them using `pip install <package-name>`.

---

## üìÇ Repo Structure

```text
disease-diagnosis/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ synthetic_dataset.csv
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ *.pkl
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îî‚îÄ‚îÄ disease_diagnosis_demo.ipynb
‚îú‚îÄ‚îÄ plots/
‚îÇ   ‚îú‚îÄ‚îÄ confusion_matrix_*.png
‚îÇ   ‚îú‚îÄ‚îÄ calibration_plot_*.png
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ generator.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ citations.md              <-- full references & citations
‚îî‚îÄ‚îÄ .gitignore
```
