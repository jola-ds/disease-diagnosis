# HealthLens: Disease Diagnosis Prediction Project

## Overview

A machine learning project that predicts disease diagnosis from symptoms and patient data.
This project demonstrates how data science can support early diagnosis and healthcare
decision-making in low-resource settings.

This project is a baseline solution with room for future optimisation, with current constraints and next steps detailed at the end.

---

## Problem Statement

Nigeria faces a dual burden of communicable and non-communicable diseases. Malaria,
tuberculosis, HIV/AIDS, and cholera remain widespread, while hypertension, diabetes,
and cardiovascular disease are sharply rising
([WHO, 2023](https://www.afro.who.int/sites/default/files/2023-08/Nigeria.pdf);
[AHA Journals, 2023](https://www.ahajournals.org/doi/10.1161/CIRCULATIONAHA.123.063671)).
Malaria alone contributes substantially to mortality and morbidity ([Reuters, 2024](https://www.reuters.com/business/healthcare-pharmaceuticals/nigeria-rolls-out-new-oxford-r21-malaria-vaccine-2024-10-17/)).

At the same time, access to timely medical intervention is limited
outside major cities, worsening preventable illness and death ([PMC, 2013](https://pmc.ncbi.nlm.nih.gov/articles/PMC3560225/); [2020](https://pmc.ncbi.nlm.nih.gov/articles/PMC7436948/)). In low-resource settings, limited infrastructure, understaffing, and
inequitable access to care remain persistent challenges, leading to gaps in diagnosis and
treatment.

Machine learning (ML) offers a way forward. Research has shown its potential in:

- Predicting under-five mortality in Nigeria with up to 89.47% accuracy
([BMC Med Inform Decis Mak, 2024](https://bmcmedinformdecismak.biomedcentral.com/articles/10.1186/s12911-024-02476-5))
- Supporting HIV treatment adherence in Nigerian patients ([PMC, 2024](https://pmc.ncbi.nlm.nih.gov/articles/PMC12021289/))
- Enhancing outbreak prediction for diseases like cholera
([Exploration Journals, 2023](https://www.explorationpub.com/Journals/edht/Article/101140))

Full Reference: [`citations.md`](citations.md)

### Scope

This project, therefore, addresses the urgent need for accessible, privacy-safe, and
context-aware disease prediction tools. Using **domain-informed synthetic Nigerian
hospital data**, a machine learning predictor was tailored to local healthcare
realities.

⚠️ This tool is for educational purposes only. While not a substitute for clinical expertise, this system demonstrates how
AI-driven models can serve as decision support tools for healthcare workers in
low-resource settings—helping flag likely diseases earlier, guide triage, and
ultimately improve patient outcomes.

---

## Solution – [HealthLens](https://disease-diagnosis-client.vercel.app/)
**HealthLens** is an AI-powered diagnostic tool that predicts likely diseases from patient symptoms and demographics, providing fast and accessible support for preliminary screening.
It is designed as a baseline solution with room for future optimization.

---

## 🌐 Interactive Interface Features
- **Real-time Prediction** – Input patient demographics and symptoms to instantly get a predicted disease.  
- **Confidence Score (Top Prediction)** – Displays the model’s probability for the most likely disease.  
- **Confidence Distribution (Other Diseases)** – Shows probabilities for other possible diseases, giving users insight into alternative diagnoses.  
- **Symptom Grouping** – Symptoms are organized into **8 intuitive categories** (e.g., General, Respiratory, Gastrointestinal, Metabolic, and Others) for easier navigation.  
- **Explanatory Tooltips** – Each symptom comes with a **short description**, helping users understand what the symptom means before selecting it.  
- **User-Friendly Form** – Simple and intuitive input fields for age, gender, setting, and symptoms.  
- **Results Display** – Clear visualization of likely and alternative diseases, with interpretation.  

---

## Dataset

A synthetic dataset including 10,000 patient records was generated by simulating patient-level disease occurrence and symptoms in Nigeria. Each record includes:

- **Demographics:** age, gender, setting, region, and season.
- **Diagnosis:** one of 10 diseases or "healthy (or undiagnosed)".
- **Symptoms:** binary indicators for symptoms.

The generator applies:

- Epidemiologically-informed **disease prevalence and demographic adjustments**
- **Seasonal effects**, **symptom correlations**, and **comorbidities**
- Optional **balanced disease datasets** or user-controlled "healthy" share.

The dataset is **validated** against realistic patterns (e.g., malaria peaks in rainy season, measles is pediatric-focused) and provides comprehensive statistics.  

For a thorough overview, see [`data/README.md`](data/README.md)

---

## Workflow

1. **Preprocessing**
   - Categorical encoding (`OneHotEncoder`) for non-numeric columns.
   - Feature selection: symptoms + basic patient data.

2. **Modeling**
   - Initially Random Forest, final model - XGBoost classifiers.
   - Balancing via sample weights to handle class imbalance.

3. **Evaluation**
   - Metrics: Accuracy, classification report.
   - Visualization: Confusion matrices, calibration plots.
   - Bootstrap confidence intervals to estimate uncertainty.

---

## Results (XGBoost Classifier)

Final model: **XGBoost**, selected after baseline comparison with Random Forest.

- **Accuracy:** 92.5%  
- **Macro F1-score:** 93%  
- **Weighted F1-score:** 93%  

This baseline implementation establishes a strong benchmark, with room for future optimization and refinement.

---

## Scripts

- [`src/data_generator.py`](src/data_generator.py): Synthetic dataset generator module.
- [`src/train.py`](src/train.py): Training utilities
- [`src/eval.py`](src/eval.py): Evaluation utilities.
- [`src/demo.py`](src/demo.py): Project demo

---

## Getting Started

Follow these steps to set up and run the Disease Diagnosis Project.

### 1. Clone the Repository

```bash
git clone https://github.com/jola-ds/disease-diagnosis.git
cd disease-diagnosis
```

### 2. (Recommended) Create a Virtual Environment

```bash
python -m venv .venv
# On Windows:
.venv\Scripts\activate
# On macOS/Linux:
source .venv/bin/activate
```

### 3. Install Dependencies

```bash
pip install -r requirements.txt
```

### 4. Usage

```bash
# Train and save the best model
python main.py train

# Evaluate the saved model on the test set
python main.py evaluate --model models/final_model.pkl

# Run the pipeline
python main.py demo --model models/final_model.pkl
```
Alternatively, explore interactively:

```bash
jupyter notebook notebooks/disease_diagnosis_demo.ipynb
```

---

**Note:**  
If you encounter missing package errors, install them using `pip install <package-name>`.

---

## 📂 Repo Structure

```text
disease-diagnosis/
├── data/
│   ├── synthetic_dataset.csv
│   ├── README.md
├── models/
│   └── *.pkl
├── notebooks/
│   └── disease_diagnosis_demo.ipynb
├── plots/
│   ├── confusion_matrix_*.png
│   ├── calibration_plot_*.png
├── src/
│   ├── generator.py
│   ├── train.py
│   ├── eval.py
│   ├── demo.py
├── main.py
├── requirements.txt
├── README.md
├── citations.md              <-- full references & citations
```

## Current Limitations

- **Lack of patient history:** Present model generates single snapshots; future iterations could simulate patient journeys over time.  
- **Assumptions vs. reality:** Probabilities are based on informed assumptions, not formally calibrated real-world datasets. 

## Future Improvements

### Enhanced Clinical Modeling
- Severity stratification (mild, moderate, severe categories)  
- Symptom duration modeling (hours, days, weeks, months)  
- Integration of laboratory values for more realistic diagnostics  
- Complication pathways to capture disease progression
- Collaboration with **domain experts** to validate assumptions, refine features, and improve clinical realism.

### Better Epidemiological Realism
- Geographic clustering (disease hotspots, local epidemics)  
- Healthcare access modeling (delayed presentation, treatment gaps)  
- Nutritional status impacts (malnutrition influencing symptoms)  

### Data Quality Enhancements
- Realistic missing data patterns in symptom reporting  
- Measurement error (e.g., thermometer accuracy, subjective symptoms)  
- Reporting bias from cultural or behavioral factors  
- Follow-up modeling for treatment response and recovery timelines  

### Technical Improvements
- Implementation of **hyperparameter tuning** to optimize model performance.  
- Exploration of **ensemble methods** (e.g., Random Forests, Gradient Boosting, or stacking) for better predictive accuracy.  
- Incorporation of **model explainability techniques** (e.g., SHAP, LIME) to understand feature importance and build trust in predictions.   

### Additional Diseases to Model
- Sickle cell disease
- Meningitis
- Hepatitis B 
- Schistosomiasis

---

⚠️ *Note: This model is excellent for training basic diagnostic algorithms, but it represents “idealised” clinical presentations rather than the complexity of real-world healthcare data.*
 
