# Disease Diagnosis Project

## Overview

A machine learning project that predicts diseases from symptoms and patient data.
This project demonstrates how data science can support early diagnosis and healthcare
decision-making in low-resource settings.

---

## Problem Statement

Nigeria faces a dual burden of communicable and non-communicable diseases. Malaria,
tuberculosis, HIV/AIDS, and cholera remain widespread, while hypertension, diabetes,
and cardiovascular disease are sharply rising
([WHO, 2023](https://www.afro.who.int/sites/default/files/2023-08/Nigeria.pdf);
[AHA Journals, 2023](https://www.ahajournals.org/doi/10.1161/CIRCULATIONAHA.123.063671)).
Malaria alone contributes substantially to mortality and morbidity ([Reuters, 2024](https://www.reuters.com/business/healthcare-pharmaceuticals/nigeria-rolls-out-new-oxford-r21-malaria-vaccine-2024-10-17/)).

At the same time, access to timely medical intervention is limited
outside major cities, worsening preventable illness and death ([PMC, 2013](https://pmc.ncbi.nlm.nih.gov/articles/PMC3560225/); [2020](https://pmc.ncbi.nlm.nih.gov/articles/PMC7436948/)). In low-resource settings, limited infrastructure, understaffing, and
inequitable access to care remain persistent challenges, leading to gaps in diagnosis and
treatment.

Machine learning (ML) offers a way forward. Research has shown its potential in:

- Predicting under-five mortality in Nigeria with up to 89.47% accuracy
([BMC Med Inform Decis Mak, 2024](https://bmcmedinformdecismak.biomedcentral.com/articles/10.1186/s12911-024-02476-5))
- Supporting HIV treatment adherence in Nigerian patients ([PMC, 2024](https://pmc.ncbi.nlm.nih.gov/articles/PMC12021289/))
- Enhancing outbreak prediction for diseases like cholera
([Exploration Journals, 2023](https://www.explorationpub.com/Journals/edht/Article/101140))

Full Reference: [`citations.md`](citations.md)

### Scope

This project, therefore, addresses the urgent need for accessible, privacy-safe, and
context-aware disease prediction tools. Using **domain-informed synthetic Nigerian
hospital data**, a machine learning predictor was tailored to local healthcare
realities.

⚠️ While not a substitute for clinical expertise, this system demonstrates how
AI-driven models can serve as decision support tools for healthcare workers in
low-resource settings—helping flag likely diseases earlier, guide triage, and
ultimately improve patient outcomes.

---

## Features

- Confidence intervals for model metrics via Bootstrap resampling (uncertainty estimates)
- Confidence score for each prediction (model probability for the predicted disease)
- Interactive demo for real-time prediction

---

## Dataset

A synthetic dataset was generated by simulating patient-level disease occurrence and symptoms in Nigeria. Each record includes:

- **Demographics:** age, gender, setting, region, and season.
- **Diagnosis:** one of 10 diseases or "healthy (or undiagnosed)".
- **Symptoms:** binary indicators for 15 common symptoms.

The generator applies:

- Epidemiologically-informed **disease prevalence and demographic adjustments**
- **Seasonal effects**, **symptom correlations**, and **comorbidities**
- Optional **balanced disease datasets** or user-controlled "healthy" share.

The dataset is **validated** against realistic patterns (e.g., malaria peaks in rainy season, measles is pediatric-focused) and provides comprehensive statistics.  

For a thorough overview, see [`data/README.md`](data/README.md)

---

## Workflow

1. **Preprocessing**
   - Categorical encoding (`OneHotEncoder`) for non-numeric columns.
   - Feature selection: symptoms + basic patient data.

2. **Modeling**
   - Initially Random Forest, final model - XGBoost classifiers.
   - Balancing via sample weights to handle class imbalance.

3. **Evaluation**
   - Metrics: Accuracy, classification report.
   - Visualization: Confusion matrices, calibration plots.
   - : Bootstrap confidence intervals to estimate uncertainty.

---

## Scripts

- [`src/data_generator.py`](src/data_generator.py): Synthetic dataset generator module.
- [`src/train.py`](src/train.py): Training utilities
- [`src/eval.py`](src/eval.py): Evaluation utilities.
- [`src/demo.py`](src/demo.py): Project demo

---

## Results (XGBoost Classifier)

Final model: **XGBoost**, selected after baseline comparison with Random Forest.

- **Accuracy:** **92.5%**  
- **Macro F1-score:**  93%
- **Weighted F1-score:** 93%

---

## Getting Started

Follow these steps to set up and run the Disease Diagnosis Project.

### 1. Clone the Repository

```bash
git clone https://github.com/<jola-ds>/<disease-diagnosis>.git
cd <disease-diagnosis>
```

### 2. (Recommended) Create a Virtual Environment

```bash
python -m venv .venv
# On Windows:
.venv\Scripts\activate
# On macOS/Linux:
source .venv/bin/activate
```

### 3. Install Dependencies

```bash
pip install -r requirements.txt
```

### 4. Command-Line Usage

```bash
# Train and save the best model
python main.py train

# Evaluate the saved model on the test set
python main.py evaluate --model models/final_model.pkl

# Run the pipeline
python main.py demo --model models/final_model.pkl
```

---

**Note:**  
If you encounter missing package errors, install them using `pip install <package-name>`.

---

## 📂 Repo Structure

```text
disease-diagnosis/
├── data/
│   ├── synthetic_dataset.csv
│   ├── README.md
├── models/
│   └── *.pkl
├── plots/
│   ├── confusion_matrix_*.png
│   ├── calibration_plot_*.png
├── src/
│   ├── generator.py
│   ├── train.py
│   ├── eval.py
│   ├── demo.py
├── main.py
├── requirements.txt
├── README.md
├── citations.md              <-- full references & citations
